{{ header }}{{ column_left }}

<div id="content">
 <!--Header Start-->
 <div class="page-header">
  <div class="container-fluid">
   <div class="pull-right"> 
		 <button type="submit" form="form-setting" data-toggle="tooltip" title="{{ button_save }}" class="btn btn-primary"><i class="fa fa-save"></i>&nbsp;{{ button_save }}</button>
		 <a onclick="batch_generate('index.php?route={{ base_route }}/hb_related/batch_generate&user_token={{ user_token }}');" id="button-batch" class="btn btn-warning"><i class="fa fa-play"></i>&nbsp;{{ button_generate }}</a>
		 <a onclick="confirm('{{ text_confirm }}') ? clear_related_products() : false;" id="button_clear" class="btn btn-danger"><i class="fa fa-trash"></i>&nbsp;{{ button_clear }}</a>
		 <a href="{{ doc_link }}" target="_blank" class="btn btn-default"><i class="fa fa-book"></i>&nbsp;{{ button_docs }}</a>
     <a href="{{ cancel }}" data-toggle="tooltip" title="{{ button_cancel }}" class="btn btn-default"><i class="fa fa-reply"></i></a> 
	 </div>
   <h1>{{ heading_title }}</h1>
   <ul class="breadcrumb">
    {% for breadcrumb in breadcrumbs %}
    <li><a href="{{ breadcrumb.href }}">{{ breadcrumb.text }}</a></li>
    {% endfor %}
   </ul>
  </div>
 </div>
 <!--Header End-->
 <div class="container-fluid">
	<!--Start - Error / Success Message if any -->
	{% if error_warning %}
		<div class="alert alert-danger"><i class="fa fa-exclamation-circle"></i> {{ error_warning }}
		<button type="button" class="close" data-dismiss="alert">&times;</button>
		</div>
	{% endif %}
	{% if success %}
		<div class="alert alert-success"><i class="fa fa-check-circle"></i> {{ success }}
		<button type="button" class="close" data-dismiss="alert">&times;</button>
		</div>
	{% endif %}
	<!--End - Error / Success Message if any -->
	
  <div class="panel panel-default">
   <div class="panel-heading">
    <h3 class="panel-title"><i class="fa fa-link"></i> {{ heading_title }}</h3>
   </div>
   <div class="panel-body">
    <div id="output-console"></div>
		<form action="{{ action }}" method="post" enctype="multipart/form-data" id="form-setting" class="form-horizontal">
			<div class="form-group">
				<label class="col-sm-3 control-label">{{ text_category }}</label>
				<div class="col-sm-9">
					<input type="checkbox" data-toggle="toggle" data-onstyle="success" name="hb_related_category" class="form-control" value="1" {{ hb_related_category == 1? 'checked':'' }}/>
				</div>
			</div>

			<div class="form-group">
				<label class="col-sm-3 control-label">{{ text_parent_category }}</label>
				<div class="col-sm-9">
					<input type="checkbox" data-toggle="toggle" data-onstyle="success" name="hb_related_parent" class="form-control" value="1" {{ hb_related_parent == 1? 'checked':'' }}/>
				</div>
			</div>
			
			<div class="form-group">
				<label class="col-sm-3 control-label">{{ text_brand }}</label>
				<div class="col-sm-3">
					<input type="checkbox" data-toggle="toggle" data-onstyle="success" name="hb_related_brand" class="form-control" value="1" {{ hb_related_brand == 1? 'checked':'' }}/>
				</div>				
			</div>

			<div class="form-group">
				<label class="col-sm-3 control-label">{{ text_random }}</label>
				<div class="col-sm-3">
					<input type="checkbox" data-toggle="toggle" data-onstyle="success" name="hb_related_random" class="form-control" value="1" {{ hb_related_random == 1? 'checked':'' }}/>
				</div>				
			</div>

			<div class="form-group">
				<label class="col-sm-3 control-label">{{ text_total_limit }}</label>
				<div class="col-sm-3">
					<input type="number" name="hb_related_limit" class="form-control color" value="{{ hb_related_limit }}" />
				</div>				
			</div>
		</form>    
   </div>
  </div>
 </div>
 <div class="container-fluid">
  <!--Huntbee copyrights-->
  <center>
   <span class="help">{{ heading_title }}- {{ extension_version }} &copy; <a href="https://www.huntbee.com/">WWW.HUNTBEE.COM</a> | <a href="https://www.huntbee.com/get-support" target="_blank">SUPPORT</a></span>
  </center>
 </div>
 <!--Huntbee copyrights end-->
</div>

<link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">
<script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"></script>

<script type="text/javascript">
function batch_generate(url) {
	$.ajax({
		url: url,
		type: 'post',
		dataType: 'json',
		beforeSend: function() {
			$('#button-batch').button('loading');
		},
		complete: function() {
			$('#button-batch').button('reset');
		},
		success: function(json) {
			$('.alert, .text-danger').remove();

			if (json['error']) {
				if (json['error']) {
					$('#output-console').html('<div class="alert alert-danger"><i class="fa fa-exclamation-circle"></i> ' + json['error'] + '</div>');
				}
			}

			if (json['success']) {
				$('#output-console').html('<div class="alert alert-success"><i class="fa fa-check-circle"></i> ' + json['success'] + '</div>');
			}
				
			if (json['next']) {
				batch_generate(json['next']);
			}
		},
		error: function(xhr, ajaxOptions, thrownError) {
			$('#button-batch').button('reset');
			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
		}
	});
}

function clear_related_products(){
	$('#output-console').html('<center><i class="fa fa-circle-o-notch fa-spin fa-3x fa-fw"></i></center>');
	$.ajax({
		type: 'post',
		url: 'index.php?route={{ base_route }}/hb_related/clear_related_products&user_token={{ user_token }}',
		dataType: 'json',
		success: function(json) {
			if (json['success']) {
				 $('#output-console').html('<div class="alert alert-success"><i class="fa fa-check"></i> '+json['success']+'<button type="button" class="close" data-dismiss="alert">&times;</button></div>');
			}
		},			
		error: function(xhr, ajaxOptions, thrownError) { alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText); }
	 });
}
</script>

{{ footer }}